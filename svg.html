<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Canvas Drawing App with Icons</title>
<style>
  body {
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    background: #f0f0f0;
    margin: 0;
    padding: 0;
  }
  #toolbar {
    margin: 10px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  button, select, input {
    padding: 5px;
    cursor: pointer;
    background: white;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  button.active {
    border: 2px solid #333;
  }
  #canvas {
    border: 2px solid #333;
    background: white;
    cursor: crosshair;
  }
  svg.icon {
    width: 24px;
    height: 24px;
    vertical-align: middle;
  }
</style>
</head>
<body>

<div id="toolbar">
  <!-- Tool Icons -->
  <button id="pencilBtn" title="Pencil"><svg class="icon" viewBox="0 0 24 24"><path d="M3 21v-3l14-14 3 3-14 14H3z" stroke="black" fill="none" stroke-width="2"/></svg></button>
  <button id="eraserBtn" title="Eraser"><svg class="icon" viewBox="0 0 24 24"><path d="M16 3l5 5-9 9H7v-5l9-9z" stroke="black" fill="none" stroke-width="2"/></svg></button>
  <button id="rectBtn" title="Rectangle"><svg class="icon" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" stroke="black" fill="none" stroke-width="2"/></svg></button>
  <button id="circleBtn" title="Circle"><svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="8" stroke="black" fill="none" stroke-width="2"/></svg></button>
  <button id="lineBtn" title="Line"><svg class="icon" viewBox="0 0 24 24"><line x1="4" y1="20" x2="20" y2="4" stroke="black" stroke-width="2"/></svg></button>

  <!-- Stroke size -->
  <select id="size">
    <option value="2">Small</option>
    <option value="5">Medium</option>
    <option value="10">Large</option>
  </select>

  <!-- Stroke and Fill colors -->
  <input type="color" id="strokeColor" value="#000000">
  <input type="color" id="fillColor" value="#ff0000">

  <button id="clear">Clear</button>
  <button id="export">Export PNG</button>
</div>

<canvas id="canvas" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

// Tool buttons
const tools = {
  pencil: document.getElementById('pencilBtn'),
  eraser: document.getElementById('eraserBtn'),
  rect: document.getElementById('rectBtn'),
  circle: document.getElementById('circleBtn'),
  line: document.getElementById('lineBtn')
};

let currentTool = 'pencil';
Object.keys(tools).forEach(tool => {
  tools[tool].addEventListener('click', () => {
    currentTool = tool;
    // highlight active
    Object.values(tools).forEach(b => b.classList.remove('active'));
    tools[tool].classList.add('active');
  });
});
tools.pencil.classList.add('active'); // default active

const sizeSelect = document.getElementById('size');
const strokeColorInput = document.getElementById('strokeColor');
const fillColorInput = document.getElementById('fillColor');
const clearBtn = document.getElementById('clear');
const exportBtn = document.getElementById('export');

let drawing = false;
let startX = 0;
let startY = 0;
let snapshot = null;

canvas.addEventListener('mousedown', (e) => {
  drawing = true;
  startX = e.offsetX;
  startY = e.offsetY;
  ctx.lineWidth = sizeSelect.value;
  ctx.strokeStyle = strokeColorInput.value;
  ctx.fillStyle = fillColorInput.value;
  ctx.lineCap = 'round';
  snapshot = ctx.getImageData(0,0,canvas.width,canvas.height);

  if (currentTool === 'pencil') {
    ctx.beginPath();
    ctx.moveTo(startX, startY);
  }
});

canvas.addEventListener('mousemove', (e) => {
  if (!drawing) return;
  const x = e.offsetX;
  const y = e.offsetY;

  if (currentTool === 'pencil') {
    ctx.lineTo(x, y);
    ctx.stroke();
  } else if (currentTool === 'eraser') {
    ctx.clearRect(x - sizeSelect.value/2, y - sizeSelect.value/2, sizeSelect.value, sizeSelect.value);
  } else {
    // restore snapshot for shapes
    ctx.putImageData(snapshot, 0, 0);
    if (currentTool === 'rect') {
      ctx.strokeRect(Math.min(startX, x), Math.min(startY, y), Math.abs(x - startX), Math.abs(y - startY));
      ctx.fillRect(Math.min(startX, x), Math.min(startY, y), Math.abs(x - startX), Math.abs(y - startY));
    } else if (currentTool === 'circle') {
      const radius = Math.sqrt((x - startX)**2 + (y - startY)**2);
      ctx.beginPath();
      ctx.arc(startX, startY, radius, 0, Math.PI*2);
      ctx.fill();
      ctx.stroke();
    } else if (currentTool === 'line') {
      ctx.beginPath();
      ctx.moveTo(startX, startY);
      ctx.lineTo(x, y);
      ctx.stroke();
    }
  }
});

canvas.addEventListener('mouseup', () => {
  drawing = false;
});

clearBtn.addEventListener('click', () => ctx.clearRect(0,0,canvas.width,canvas.height));
exportBtn.addEventListener('click', () => {
  const link = document.createElement('a');
  link.download = 'drawing.png';
  link.href = canvas.toDataURL();
  link.click();
});
</script>

</body>
</html>
